var U=Object.defineProperty,M=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var k=(i,e,t)=>e in i?U(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,o=(i,e)=>{for(var t in e||(e={}))Y.call(e,t)&&k(i,t,e[t]);if(L)for(var t of L(e))H.call(e,t)&&k(i,t,e[t]);return i},c=(i,e)=>M(i,O(e));var h=(i,e,t)=>(k(i,typeof e!="symbol"?e+"":e,t),t),v=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var _=(i,e,t)=>(v(i,e,"read from private field"),t?t.call(i):e.get(i)),w=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},S=(i,e,t,n)=>(v(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t);const j=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}};j();const q="https://picsum.photos/",K=10,W="formApp__step",x="formApp__step--active",T="prev",N="next",F="back",z="front",G={currentStep:1,steps:[],disableNextButton:!1,disablePrevButton:!0,isFinalized:!1,customer:{name:"",surname:"",phone:"",email:"",address:"",city:"",zip_code:"",building_number:"",flat_number:""},product:{print_location:z,image_src:"",price:K}};var g;class s{static setProperty(e){const t=e(_(this,g)),n=_(this,g);S(this,g,t),this.subscribers.forEach(r=>{r(t,n)})}static subscribe(e){this.subscribers.push(e)}static getState(){return _(this,g)}static getProperty(e){return _(this,g)[e]}}g=new WeakMap,w(s,g,G),h(s,"subscribers",[]);class y{static async generateImage(){const t=await(await fetch(`${q}/id/${this.currentImageID}/${this.imageSize}`)).blob();s.setProperty(n=>c(o({},n),{product:c(o({},n.product),{image_src:URL.createObjectURL(t)})}))}static setNextImage(){return this.currentImageID++,this.generateImage()}static setPreviousImage(){if(this.currentImageID!==1)return this.currentImageID--,this.generateImage()}}h(y,"currentImageID",Math.floor(Math.random()*100)),h(y,"imageSize",530);const A=i=>{switch(i){case z:return"Prz\xF3d koszulki";case F:return"Ty\u0142 koszulki"}},m=({text:i=""})=>{const e=document.createElement("p");return e.classList.add("text"),e.innerHTML=i,e};class X{constructor(e){this.rootElement=e}render(){const e=s.getProperty("product"),t=s.getProperty("customer"),n=o(o({},e),t),r=document.createElement("div");r.classList.add("thankYou__grid");const a=document.createElement("div");a.classList.add("thankYou__imageContainer"),a.innerHTML=`<img src="${e.image_src}" alt="Selected Image" class="thankYou__image">`;const d=document.createElement("div");d.classList.add("thankYou");const p=document.createElement("h3");p.innerText="Dzi\u0119kujemy za z\u0142o\u017Cenie zam\xF3wienia",p.classList.add("headline","headline--small","headline--center");const l=document.createElement("div");l.classList.add("thankYou__data"),l.appendChild(m({text:`Strona koszulki: ${A(e.print_location)}`})),l.appendChild(m({text:`Cena: ${e.price} jednostek`})),l.appendChild(m({text:`Imi\u0119 i nazwisko: ${t.name} ${t.surname}`})),l.appendChild(m({text:`Numer telefonu: ${t.phone}`})),l.appendChild(m({text:`E-mail: ${t.email}`})),l.appendChild(m({text:`Adres: ${t.address} ${t.building_number} ${t.flat_number}, <br> ${t.zip_code}, <br> ${t.city}`})),r.appendChild(l),r.appendChild(a),d.appendChild(p),d.appendChild(r),this.rootElement.appendChild(d),console.log(n)}}class Z{constructor(e,t,n){this.stepsUI=e,this.previewUI=t,this.currentPriceUI=n,this.rootElement=document.querySelector(".formApp")}addStep(e){s.setProperty(t=>c(o({},t),{steps:[...t.steps,e]}))}start(){this.stepsUI.render(),y.generateImage(),s.subscribe((e,t)=>{e.currentStep!==t.currentStep&&(this.stepsUI.handleDisableButtons(),this.stepsUI.render(!0),this.currentPriceUI.render())}),s.subscribe((e,t)=>{e.disableNextButton!==t.disableNextButton&&this.stepsUI.renderHeadingElement()}),s.subscribe((e,t)=>{e.product!==t.product&&(this.previewUI.render(),this.stepsUI.render())}),s.subscribe((e,t)=>{e.isFinalized!==t.isFinalized&&(this.rootElement.innerHTML="",new X(this.rootElement).render())})}}class J{constructor(e,t){this.headingElement=document.querySelector(e),this.contentElement=document.querySelector(t)}render(e=!1){this.renderHeadingElement(),this.renderContentElement(e)}renderHeadingElement(){this.headingElement.innerHTML="",this.headingElement.appendChild(this.createButton("Wstecz",this.handlePrevStep.bind(this),T)),this.headingElement.appendChild(this.generateSteps()),this.headingElement.appendChild(this.createButton("Dalej",this.handleNextStep.bind(this),N))}renderContentElement(e){this.contentElement.innerHTML="";const t=s.getProperty("currentStep");s.getProperty("steps")[t-1].render(this.contentElement,e)}generateStep(e,t){const n=t+1,r=document.createElement("div");return r.classList.add(W),r.innerText=`${n}. ${e.label}`,r.classList.remove(x),n===s.getProperty("currentStep")&&r.classList.add(x),r}generateSteps(){const e=document.createElement("div");return e.classList.add("formApp__stepsContainer"),s.getProperty("steps").forEach((t,n)=>{e.appendChild(this.generateStep(t,n))}),e}createButton(e,t,n){const r=document.createElement("button");switch(r.classList.add("button"),r.innerText=e,r.addEventListener("click",()=>t(r)),n){case T:r.disabled=s.getProperty("disablePrevButton");break;case N:r.disabled=s.getProperty("disableNextButton");break}return r}handlePrevStep(){s.setProperty(e=>c(o({},e),{currentStep:e.currentStep-1}))}handleNextStep(){s.setProperty(e=>c(o({},e),{currentStep:e.currentStep+1}))}handleDisableButtons(){s.setProperty(e=>c(o({},e),{disablePrevButton:s.getProperty("currentStep")===1})),s.setProperty(e=>c(o({},e),{disableNextButton:s.getProperty("currentStep")>=s.getProperty("steps").length}))}}var Q="/assets/shirt_back.a75dfdad.png",ee="/assets/shirt_front.a7fb7165.png";class te{constructor(e){this.previewElement=document.querySelector(e),this.render()}render(){this.previewElement.innerHTML="",this.previewElement.appendChild(this.createShirtImage()),this.previewElement.appendChild(this.createPickedImagePreview())}createShirtImage(){const e=document.createElement("img");return e.width="218",e.height="236",e.src=s.getProperty("product").print_location===F?Q:ee,e}createPickedImagePreview(){const e=document.createElement("img");return e.classList.add("formApp__previewPickedImage"),e.src=s.getProperty("product").image_src,e}}class re{constructor(e){this.priceElement=document.querySelector(e),this.render()}render(){this.priceElement.innerHTML="",this.priceElement.appendChild(this.createPriceField())}createPriceField(){const e=s.getProperty("product").price,t=document.createElement("p");return t.classList.add("formApp__price"),t.innerText=`Aktualna Cena: ${e} jednostek`,t}}class E{constructor(e,t,n){this.label=e,this.id=t,this.callback=n}render(e,t){const n=document.createElement("div");n.classList.add("formApp__stepContent"),t?n.classList.add("formApp__stepContent--active"):n.classList.remove("formApp__stepContent--active"),e.appendChild(n),this.callback(n)}}class ${constructor(){this.errors=[],this.formContainerElement=document.createElement("div"),this.subscribers=[]}createField({fieldType:e,fieldName:t,fieldLabel:n,fieldID:r,fieldValue:a,fieldCallback:d,fieldIsChecked:p,fieldValidationRules:l=[]}){const b=document.createElement("div");b.classList.add("formField");const I=document.createElement("label");I.classList.add("formField__label"),I.innerText=n,I.setAttribute("for",r);const u=document.createElement("input");u.classList.add("formField__input"),u.type=e,u.id=r,u.name=t,u.value=a,u.addEventListener("input",d),e==="radio"&&(u.checked=p,b.classList.add("formField--row")),b.appendChild(I),b.appendChild(u),l.length&&(this.handleValidation(l,u,b),l.forEach(R=>{this.validateFieldByRule(R,u,u.value)})),this.formContainerElement.appendChild(b)}renderFields(e){e.appendChild(this.formContainerElement)}handleValidation(e,t,n){const r=document.createElement("div");n.appendChild(r),t.addEventListener("input",a=>{r.innerHTML="";const d=a.target.value;e.forEach(p=>{this.validateFieldByRule(p,t,d,r)})})}validateFieldByRule(e,t,n,r=null){e.isInvalid(n)?(r&&e.printMessage(r),this.errors.push({fieldName:t.name,message:e.message})):this.errors=this.errors.filter(a=>a.fieldName!==t.name),this.subscribers.forEach(a=>a(this.errors))}subscribe(e){this.subscribers.push(e)}getErrors(){return this.errors}}const ie=i=>{const e=new $,t=n=>{s.setProperty(r=>c(o({},r),{product:c(o({},r.product),{print_location:n.target.value})}))};e.createField({fieldType:"radio",fieldName:"overprint-location",fieldLabel:"Prz\xF3d koszulki",fieldValue:"front",fieldID:"front",fieldIsChecked:s.getProperty("product").print_location==="front",fieldCallback:t}),e.createField({fieldType:"radio",fieldName:"overprint-location",fieldLabel:"Ty\u0142 koszulki",fieldValue:"back",fieldID:"back",fieldIsChecked:s.getProperty("product").print_location==="back",fieldCallback:t}),e.renderFields(i)},ne=new E("Miejsce Nadruku","overprint-location",ie),se=i=>{const e=l=>{l.preventDefault(),y.setNextImage()},t=l=>{l.preventDefault(),y.setPreviousImage()},n=document.createElement("h2");n.innerText="Wybierz zdj\u0119cie",n.classList.add("headline","headline--small");const r=document.createElement("img");r.src=s.getProperty("product").image_src,r.width="250",r.height="250";const a=document.createElement("div");a.classList.add("buttonsContainer");const d=document.createElement("button");d.innerText="Poprzednie zdj\u0119cie",d.classList.add("button"),d.addEventListener("click",t);const p=document.createElement("button");p.innerText="Nast\u0119pne zdj\u0119cie",p.classList.add("button"),p.addEventListener("click",e),a.appendChild(d),a.appendChild(p),i.appendChild(n),i.appendChild(r),i.appendChild(a)},ae=new E("Wybierz grafik\u0119","choose-graphic",se);class P{static printMessage(e,t="error"){const n=document.createElement("p");n.classList.add("formField__message",`formField__message--${t}`),n.innerText=this.message,e.appendChild(n)}static isInvalid(){throw new Error("Method isInvalid is not implemented")}}h(P,"message","");class D extends P{static isInvalid(e){return!/\S+@\S+\.\S+/.test(e)}}h(D,"message","Niepoprawny adres email.");class V extends P{static isInvalid(e){return!/^\d{9}$/.test(e)}}h(V,"message","Niepoprawny numer telefonu");class f extends P{static isInvalid(e){return e==null||e===""}}h(f,"message","To pole jest wymagane.");class B extends P{static isInvalid(e){return!e.match(/^[0-9]{2}-[0-9]{3}$/)}}h(B,"message","Niepoprawny kod pocztowy");const de=i=>{const e=new $;e.subscribe(n=>{s.setProperty(r=>c(o({},r),{disableNextButton:n.length}))});const t=n=>{const{name:r,value:a}=n.target;s.setProperty(d=>c(o({},d),{customer:c(o({},d.customer),{[r]:a})}))};e.createField({fieldType:"text",fieldName:"name",fieldLabel:"Imi\u0119*",fieldValue:s.getProperty("customer").name,fieldID:"name",fieldCallback:t,fieldValidationRules:[f]}),e.createField({fieldType:"text",fieldName:"surname",fieldLabel:"Nazwisko*",fieldValue:s.getProperty("customer").surname,fieldID:"surname",fieldCallback:t,fieldValidationRules:[f]}),e.createField({fieldType:"email",fieldName:"email",fieldLabel:"E-mail*",fieldValue:s.getProperty("customer").email,fieldID:"email",fieldCallback:t,fieldValidationRules:[f,D]}),e.createField({fieldType:"text",fieldName:"phone",fieldLabel:"Numer telefonu*",fieldValue:s.getProperty("customer").phone,fieldID:"phone",fieldCallback:t,fieldValidationRules:[f,V]}),e.createField({fieldType:"text",fieldName:"address",fieldLabel:"Ulica*",fieldValue:s.getProperty("customer").address,fieldID:"address",fieldCallback:t,fieldValidationRules:[f]}),e.createField({fieldType:"text",fieldName:"building_number",fieldLabel:"Numer budynku*",fieldValue:s.getProperty("customer").building_number,fieldID:"building_number",fieldCallback:t,fieldValidationRules:[f]}),e.createField({fieldType:"text",fieldName:"flat_number",fieldLabel:"Numer mieszkania",fieldValue:s.getProperty("customer").flat_number,fieldID:"flat_number",fieldCallback:t}),e.createField({fieldType:"text",fieldName:"city",fieldLabel:"Miasto*",fieldValue:s.getProperty("customer").city,fieldID:"city",fieldCallback:t,fieldValidationRules:[f]}),e.createField({fieldType:"text",fieldName:"zip_code",fieldLabel:"Kod pocztowy*",fieldValue:s.getProperty("customer").zip_code,fieldID:"zip_code",fieldCallback:t,fieldValidationRules:[f,B]}),e.renderFields(i)},le=new E("Dane klienta","customer-data",de),oe=i=>{const e=s.getProperty("product"),t=s.getProperty("customer"),n=document.createElement("h3");n.innerText="Podsumowanie zam\xF3wienia",n.classList.add("headline","headline--small");const r=document.createElement("div");r.appendChild(m({text:`Strona koszulki: ${A(e.print_location)}`})),r.appendChild(m({text:`Imi\u0119 i nazwisko: ${t.name} ${t.surname}`})),r.appendChild(m({text:`Numer telefonu: ${t.phone}`})),r.appendChild(m({text:`E-mail: ${t.email}`})),r.appendChild(m({text:`Adres: ${t.address} ${t.building_number} ${t.flat_number}, <br> ${t.zip_code}, <br> ${t.city}`}));const a=document.createElement("button");a.classList.add("button"),a.innerText="Z\u0142\xF3\u017C zam\xF3wienie",a.addEventListener("click",()=>{s.setProperty(d=>c(o({},d),{isFinalized:!0}))}),i.appendChild(n),i.appendChild(r),i.appendChild(a)},ce=new E("Podsumowanie","summary",oe),pe=new J(".formApp__steps",".formApp__content"),ue=new te(".formApp__preview"),me=new re(".formApp__summary"),C=new Z(pe,ue,me);C.addStep(ne);C.addStep(ae);C.addStep(le);C.addStep(ce);C.start();
